@model IEnumerable<CNWEB22CT1.Models.OrderModel>

<!DOCTYPE html>
<html>
<head>
    <title>Danh sách đơn hàng</title>
</head>
<body>
    <div class="container mt-5">
        <h1 class="text-center">Danh sách đơn hàng của bạn</h1>
        <table class="table table-striped mt-4">
            <thead>
                <tr>
                    <th>#</th>
                    <th>Mã đơn hàng</th>
                    <th>Ngày tạo</th>
                    <th>Trạng thái</th>
                    <th>Chi tiết đơn hàng</th>
                </tr>
            </thead>
            <tbody>
                @if (Model != null && Model.Any())
                {
                    int index = 1;
                    foreach (var order in Model)
                    {
                        <tr>
                            <td>@index</td>
                            <td>@order.OrderCode</td>
                            <td>@order.CreatedDate.ToString("dd/MM/yyyy HH:mm")</td>
                            <td>
                                @(order.Status == 2 ? $"Hoàn thành vào lúc {order.ApprovedDate?.ToString("dd/MM/yyyy HH:mm")}" : "Đang xử lý")
                            </td>

                            <td>
                                <a asp-action="OrderDetails" asp-route-orderCode="@order.OrderCode" class="btn btn-info btn-sm">Xem chi tiết</a>
                            </td>
                        </tr>
                        index++;
                    }
                }
                else
                {
                    <tr>
                        <td colspan="5" class="text-center">Bạn chưa có đơn hàng nào.</td>
                    </tr>
                }
            </tbody>
            @*<tbody>
                @if (Model != null && Model.Any())
                {
                    int index = 1;
                    // Lấy múi giờ Việt Nam
                    var vietNamTimeZone = TimeZoneInfo.FindSystemTimeZoneById("SE Asia Standard Time");

                    foreach (var order in Model)
                    {
                        // Chuyển đổi thời gian CreatedDate và ApprovedDate sang múi giờ Việt Nam
                        var createdDateVN = TimeZoneInfo.ConvertTimeFromUtc(order.CreatedDate, vietNamTimeZone);
                        var approvedDateVN = order.ApprovedDate.HasValue
                        ? TimeZoneInfo.ConvertTimeFromUtc(order.ApprovedDate.Value, vietNamTimeZone)
                        : (DateTime?)null;

                        <tr>
                            <td>@index</td>
                            <td>@order.OrderCode</td>
                            <td>@createdDateVN.ToString("dd/MM/yyyy HH:mm")</td>
                            <td>
                                @(order.Status == 2
                                    ? $"Hoàn thành vào lúc {approvedDateVN?.ToString("dd/MM/yyyy HH:mm")}"
                                    : "Đang xử lý")
                            </td>
                            <td>
                                <a asp-action="OrderDetails" asp-route-orderCode="@order.OrderCode" class="btn btn-info btn-sm">Xem chi tiết</a>
                            </td>
                        </tr>
                        index++;
                    }
                }
                else
                {
                    <tr>
                        <td colspan="5" class="text-center">Bạn chưa có đơn hàng nào.</td>
                    </tr>
                }
            </tbody>*@
        </table>
    </div>
</body>
</html>
